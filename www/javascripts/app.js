(function(){var a=function(b,c){return function(){return b.apply(c,arguments)}};$(function(){var c,e,d,b,f;if(!navigator.geolocation){alert("bro you need geolocation")}f=$("#text");d=$("#infoBox");c=(function(){function g(){this.getLocation=a(this.getLocation,this);var j,h,i;j={zoom:17,draggable:false,disableDoubleClickZoom:true,disableDefaultUI:true,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:false};h=[{featureType:"all",stylers:[{saturation:-100}]}];i=new google.maps.StyledMapType(h,{name:"nom"});this.map=new google.maps.Map(document.getElementById("map"),j);this.map.mapTypes.set("nom",i);this.map.setMapTypeId("nom");this.service=new google.maps.places.PlacesService(this.map)}g.prototype.getLocation=function(){return navigator.geolocation.getCurrentPosition(a(function(i){var h;h=[i.coords.latitude,i.coords.longitude],this.lat=h[0],this.lng=h[1];this.location=new google.maps.LatLng(this.lat,this.lng);return this.setupClient()},this),function(){return f.html("Sorry partner. You need to enable HTML5 geolocation to ride this pony.")})};g.prototype.setupClient=function(){f.html("Finding a place to eat...");return setTimeout(a(function(){setTimeout(function(){});window.searchCallbackHandler=this.searchCallbackHandler;return this.search()},this),1000)};g.prototype.addMarker=function(i){var h;h={icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAtCAMAAACQyRsgAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAxQTFRFAAAATExM9/f3////GVqiygAAAAR0Uk5T////AEAqqfQAAABOSURBVHja7NE7CgAgDAPQJN7/zmqr+OniIjgYKNgHdWiRLAToL/S+iwMsH65C2Hq4ywYKI/RP2UCtL6IKwhQVwJJDIEcZpLnehT1ZgAEAjaUEjHrniXIAAAAASUVORK5CYII=",visible:true,map:this.map,position:i.geometry.location};this.restaurantMarker=new google.maps.Marker(h);return this.map.setCenter(i.geometry.location)};g.prototype.search=function(){if(this.data){return b.draw(this.data)}else{return this.service.search({location:this.location,radius:3200,types:["restaurant","food","bar","bakery"]},searchCallbackHandler)}};g.prototype.searchCallbackHandler=function(i,h){this.data=i;return b.draw(i)};return g})();e=(function(){var g;g=["Nom on some <a>#{ this.name }</a>, buddy!","Break bread at <a>#{ this.name }</a>, brother.","Chow down at <a>#{ this.name }</a>, champ!","Put away some <a>#{ this.name }</a>, partner!","Demolish some <a>#{ this.name }</a>, bro.","Try out some <a>#{ this.name }</a>, lil' guy.","Gobble up some <a>#{ this.name }</a>, turkey.","Stuff your face at <a>#{ this.name }</a>, dude.","Throw back some <a>#{ this.name }</a>, boss.","Chew on some <a>#{ this.name }</a>, chief.","Chew on some <a>#{ this.name }</a>, you animal.","Chew on some <a>#{ this.name }</a>, you animal."];h.prototype.clickHandler=function(){var i;i=this.tagline.clone(true);this.tagline.before(i).remove();this.tagline=i;return this.map.getLocation()};function h(){this.draw=a(this.draw,this);this.detailsCallbackHandler=a(this.detailsCallbackHandler,this);this.clickHandler=a(this.clickHandler,this);f.html("Finding your location...");this.map=new c;this.map.getLocation();this.counter=0;this.tagline=$("h2.tagline");this.tagline.css("cursor","pointer").click(this.clickHandler);($("h1")).click(this.clickHandler)}h.prototype.selectRandom=function(i){return i[Math.floor(Math.random(i.total)*i.length)]};h.prototype.template=function(j,i){return function(l,k){return j.replace(/#{([^}]*)}/g,function(m,n){return Function("x","with(x)return "+n).call(l,k||i||{})})}};h.prototype.info=function(j){var i;i=this.template(($("#info")).text());d.html(i(j));return f.find("a").attr("href",j.url)};h.prototype.headline=function(j){var i;i=this.template(this.selectRandom(g));f.html(i(j));window.detailsCallbackHandler=this.detailsCallbackHandler;return this.map.service.getDetails({reference:j.reference},detailsCallbackHandler)};h.prototype.detailsCallbackHandler=function(j,i){b.info(j);return this.map.addMarker(j)};h.prototype.draw=function(j){var i;if(!j.length){return f.html("Looks like you&rsquo;re in the middle of nowhere, buddy!")}i=this.selectRandom(j);return this.headline(i)};return h})();return b=new e})}).call(this);
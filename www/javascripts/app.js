(function(){var a=function(b,c){return function(){return b.apply(c,arguments)}};$(function(){var b,c;if(!navigator.geolocation){alert("fuck")}b=(function(){function d(){this.draw=a(this.draw,this);this.setupClient=a(this.setupClient,this);this.getLocation=a(this.getLocation,this);this.text=$("#text");this.getLocation()}d.prototype.getLocation=function(){this.text.text("Finding your location...");console.log("getLocation");return navigator.geolocation.getCurrentPosition(a(function(f){var e;e=[f.coords.latitude,f.coords.longitude],this.lat=e[0],this.lng=e[1];console.log(this.lat,this.lng);return this.setupClient()},this))};d.prototype.selectRandom=function(e){return e[Math.floor(Math.random(e.total)*e.length)]};d.prototype.template=function(f,e){return function(h,g){return f.replace(/#{([^}]*)}/g,function(i,j){return Function("x","with(x)return "+j).call(h,g||e||{})})}};d.prototype.setupClient=function(){var e;this.text.text("Finding a place to eat...");console.log("setupClient");window.callbackHandler=e=function(h,f){var g,i;console.log(h,f);return c.draw(h!=null?(g=h.query)!=null?(i=g.results)!=null?i.Result:void 0:void 0:void 0)};return this.search()};d.prototype.search=function(){return $.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20local.search%20where%20latitude%3D'"+this.lat+"'%20and%20longitude%3D'"+this.lng+"'%20and%20query%3D'restaurant'&format=json&diagnostics=true",callbackHandler)};d.prototype.draw=function(f){var e;e=this.selectRandom(f);c.text.text("eat at "+e.Title);console.log(e);return console.log("draw")};return d})();return c=new b})}).call(this);